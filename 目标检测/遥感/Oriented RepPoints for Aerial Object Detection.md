# Oriented RepPoints for Aerial Object Detection

[**相关链接**](#相关链接)  
[**0.摘要 Abstract**](#0.摘要Abstract)  
[**1.介绍 Introduction**](#1.介绍Introduction)  
[**2.相关工作 Related work**](#2.相关工作Relatedwork)  
&emsp;[**2.1 有向目标检测**](#2.1有向目标检测)  
&emsp;[**2.2 非轴对齐特征学习**](#2.2非轴对齐特征学习)  
&emsp;[**2.3 目标检测样本分配**](#2.3目标检测样本分配)  
[**3.网络结构**](#3.网络结构)  
&emsp;[**3.1 Overview**](#3.1Overview)  
&emsp;[**3.2 有向点自适应学习**](#3.2有向点自适应学习)  
&emsp;[**3.3 自适应点的评估和分配**](#3.3自适应点的评估和分配)  
[**4.实验 Experiments**](#4.实验Experiments)  
&emsp;[**4.1 评估测试平台**](#4.1评估测试平台)  
&emsp;[**4.2 实验细节**](#4.2实验细节)  
&emsp;[**4.3 消融实验**](#4.3消融实验)  
&emsp;[**4.4 和SOTA方法比较**](#4.4和SOTA方法比较)  
&emsp;[**4.5 对方向准确性的评估**](#4.5对方向准确性的评估)  
[**5.结论 Conclusion**](#5.结论Conclusion)  



## 相关链接
参考博文链接：  
参考视频链接：  
源码链接：  
论文链接：https://arxiv.org/abs/2105.11111

<a id="0.摘要Abstract"></a>
## 0.摘要 Abstract
与通用对象相比，航空目标通常不是轴对齐的，具有任意方向并且周围环境混乱。与主流方法通过回归边界框方向不同，本文提出了一种有效的自适应点学习方法，通过利用自适应点表示法来实现对航空目标的检测，能够捕捉任意方向实例的几何信息。为此，提出了三种定向转换功能，以促进具有准确方向的分类和定位。此外，我们提出了一种有效的质量评估和样本分配方案，用于自适应点学习，以在训练过程中选择代表性的有方向的重点样本，并能够捕捉邻近对象或背景噪声的非轴对齐特征。引入了空间约束来惩罚异常点，以实现鲁棒的自适应学习。在包括DOTA、HRSC2016、UCAS-AOD和DIOR-R在内的四个具有挑战性的航空数据集上的实验结果证明了我们提出的方法的有效性。源代码可在以下链接找到：https://github.com/LiWentomng/OrientedRepPoints。

<a id="1.介绍Introduction"></a>
## 1.介绍 Introduction
作为一个重要的计算机视觉任务，航空目标检测最近引起了越来越多的关注，在远程图像理解中发挥着重要作用。与通用目标检测不同，航空目标定位具有自身的困难，包括具有任意方向的非轴对齐对象和具有复杂上下文的密集分布。主流方法通常将航空目标检测视为旋转对象定位的问题。其中，基于直接角度的定向回归方法主导了这一研究领域，这些方法源自通用的普通检测器，并具有额外的定向参数。尽管已经取得了令人满意的性能，但直接的定向预测仍然存在一些问题，包括损失的不连续性和回归的不一致性。这主要是由于角度方向的周期性限制以及旋转边界框的定义所致。尽管它们具有吸引人的定位结果，基于方向回归的检测器可能无法准确预测方向，如图1-(a)所示。

![image](https://github.com/Cloud-Jowen/CVPaper_Note/assets/56760687/8a478255-555a-42fe-ab17-6c33493eb207)  
(图1中，(a)表示基于方向回归方法的常见基准线RetinaNet [19]，(b)是我们提出的Oriented RepPoints的基准方法。与直接的方向回归相比，我们的方法可以通过学习标记为红色的自适应点来更准确地估计方向。)

为了有效解决上述问题，我们重新审视了航空物体的表示形式，以避免对敏感方向的估计。作为一种细粒度的对象表示，点集表现出很大的潜力，可以捕获传统通用检测器中的关键语义特征，如RepPoints [46]所示。然而，它的简单转换函数只能产生直立水平的边界框，无法精确估计航空物体的方向。此外，RepPoints只根据语义特征回归关键点，而忽略了有效衡量学习点质量的问题。这可能导致在航空图像中具有密集分布和复杂场景的非轴对齐物体的性能不佳。

在本工作中，我们提出了一种面向航空图像的定向物体检测器，名为Oriented RepPoints，它引入了适应性点表示，用于多样化的方向、形状和姿态。与传统的方向回归方法相比，我们提出的方法不仅可以实现精确的航空检测和准确的方向估计，而且可以捕获任意方向的航空实例的基础几何结构，如图1所示。具体来说，初始的适应性点是从中心点生成的，然后进一步调整以适应航空物体。为了获得定向边界框，我们根据学习点的布局提出了三个定向转换函数。此外，我们提出了一种有效的自适应点评估和分配（APAA）方案，用于点集学习，该方案在训练过程中不仅从分类、定位角度评估定向Reppoints的质量，还从它们的方向和点特征相关性来衡量。这种方案使检测器能够捕获相邻物体或背景噪声中的非轴对齐特征，从而分配代表性的定向Reppoints样本。此外，我们提出了一个空间约束，以帮助脆弱的点在航空场景中找到它们的实例所有者。与基于方向回归的方法相比，我们的框架获得了更精确的检测性能和准确的方向估计。

总之，本文的主要贡献包括：  
（1）提出了一种名为Oriented RepPoints的有效航空目标检测器，其中引入了灵活的自适应点作为表示，实现了定向目标检测；  
（2）针对自适应点学习，提出了一种新颖的质量评估和样本分配方案，该方案不仅从分类、定位角度选择点样本，还从方向、点特征相关性方面进行选择；  
（3）在四个具有挑战性的数据集上进行了大量实验，展示了有希望的定性和定量结果。 

![image](https://github.com/Cloud-Jowen/CVPaper_Note/assets/56760687/bdc10e27-ea1e-4c03-bb31-ae416918b0aa)  
(表 4. 在 DOTA 数据集上与最先进方法的比较。所有报告结果均在单尺度的 DOTA 数据集上进行。红色表示该列中的最佳结果，蓝色表示次佳结果。"-O"表示具有定向边界框的检测结果（下同），该表在文中没有引用位置)

<a id="2.相关工作Relatedwork"></a>
## 2.相关工作 Related work
与大多数使用水平边界框的通用物体检测器不同，航空图像中的目标通常是任意方向的，并且密集分布。我们将在接下来讨论相关工作。

<a id="2.1有向目标检测"></a>
### 2.1 有向目标检测 Oriented Object detection
最近的航空目标检测方法主要是从经典的物体检测器中引入了方向回归。SCRDet [45]、CADNet [47]、DRN [24]、R3Det [42]、ReDet [9]和Oriented RCNN [36]通过预测边界框的旋转角度实现了令人满意的性能。Gliding Vertex [37]和RSDet [25]通过回归四边形改进了检测结果。为解决基于角度的方向估计中的边界不连续性，Yang等人将角度回归转换为角度分类 [40]。随后，Yang等人将旋转边界框的参数化转换为2-D高斯分布，这为定向目标检测获得了更加稳健的结果。这些方法致力于利用旋转角度表示来改善方向估计。相反，本文引入了一种更有效的表示，即使用自适应点。

<a id="2.2非轴对齐特征学习"></a>
### 2.2 非轴对齐特征学习 Non-axis Aligned Features Learning
大多数传统的目标检测方法 [?, ?, 26, 28, 31, 46, 51] 集中于垂直或轴对齐的对象，而对于在复杂背景中密集分布的非轴对齐目标可能存在困难。为了解决这个问题，Ding等人 [3] 对轴对齐的感兴趣区域 (RoIs) 进行空间变换，并在定向边界框的监督下学习非轴对齐表示。SCRDet++ [44] 增强了非轴对齐特征，并通过训练网络带来更高的对象响应。Han等人 [8] 设计了一个特征对齐模块，以减轻轴对齐卷积特征与任意定向对象之间的错位。DRN [24] 提出了特征选择模块，以从不同的核大小、形状和方向中聚合非轴对齐信息，并采用动态滤波器生成器进行进一步回归。Guo等人 [7] 使用凸包表示来学习不规则的形状和布局，旨在通过可学习的特征适应避免特征混叠。我们基于点集的方法旨在捕捉非轴对齐航空目标的关键特征。

<a id="2.3目标检测样本分配"></a>
### 2.3 目标检测样本分配 Samples Assignment for Object Detection
大量的检测方法采用了一种简单的方式来设置IoU阈值来选择正样本。然而，这样的方案由于潜在的噪声和困难情况，无法保证训练样本的整体质量 [15, 22]。一些最近的通用目标检测样本分配方法，如ATSS [48]、FreeAnchor [49]、PAA [13] 和OTA [6]，采用了学习匹配优化策略 [50] 来选择高质量的样本。在航空场景中，由于方向的多样性和密集分布，选择高质量的样本对于学习定向检测器至关重要。Ming等人 [23] 引入了匹配度量度来评估基于定向锚点的空间对齐，使用匹配敏感损失来增强分类和定向定位之间的相关性。在这项工作中，我们建议一个有效的质量评估和样本分配方案，以选择正样本点样本。

<a id="3.网络结构"></a>
## 3.网络结构
<a id="3.1Overview"></a>
### 3.1 Overview
与传统方法 [3, 8, 9, 45] 直接回归方向不同，我们利用自适应点集 [46] 作为一种细粒度表示，能够捕捉在混乱环境中方向变化明显的航空目标的几何结构。为此，我们引入了可微分的转换函数，其中代表性点被驱使自适应地向定向对象的适当位置移动。为了有效地学习高质量的自适应点而无需直接进行点对点的监督，我们提出了一个质量评估方案，在训练阶段选择高质量的定向代表点。为了促进鲁棒的自适应点学习，我们采用空间约束来惩罚易受攻击的离群值，并从复杂的航空背景中找到它们的实例所有者。图2显示了我们提出的定向代表点方法的概述。

![image](https://github.com/Cloud-Jowen/CVPaper_Note/assets/56760687/b5081256-b1a0-4adb-9dc3-ef703e951789)  
(图2. 定向Reppoints的框架。所提出的方法是一种无锚点的方法，采用自适应点作为表示，其中使用带有FPN网络的主干进行特征编码。共享头部的结构与RepPoints [46] 在每个FPN尺度上的结构相同，除了所提出的APAA和定向转换函数。基于从初始化阶段学习点的情况，APAA方案仅在训练期间执行。)

<a id="3.2有向点自适应学习"></a>
### 3.2 有向点自适应学习 Adaptive Points Learning with Orientation
为了促进具有点集表示的定向检测器，引入了转换函数将自适应点转换为定向边界框。设G表示定向转换函数如下：
```math
OB = G(R)
```
其中OB表示从学习到的点集R转换而来的定向框。在本文中，我们研究了三种定向转换函数：  
• MinAreaRect旨在从学习的点集中找到具有最小面积的旋转矩形，适用于定向对象。  
• NearestGTCorner利用地面实况注释。对于每个角落，我们从学习到的点集中找到最接近的点作为预测的角落，选择的角点用于构建一个四边形作为定向边界框。  
• ConvexHull。一个定向实例多边形可以被定义为一组由Jarvis March算法 [7, 11]生成的点的凸包，这被许多基于轮廓的方法所使用。  

需要注意的是，NearestGTCorner和ConvexHull是可微分函数，而MinAeraRect不是。因此，我们在后处理中使用MinAeraRect来获得标准的旋转矩形预测，而另外两个可微分函数则用于优化训练过程中的自适应点学习。在定向地面实况注释的监督下，这些点针对每个空中对象的语义关键点和几何特征进行自适应调整，同时受到分类和定位损失的驱动。

所提出的框架包括两个阶段。初始化阶段通过从对象中心点（特征图网格）精炼生成自适应点集。进一步的细化阶段通过最小化如下损失函数获得精确调整：
```math
L = L_{cls} + \lambda_1 L_{s1} +\lambda_2 L_{s2}
```
其中 $` \lambda_1 `$ 和$` \lambda_2 `$是平衡权重。$` L_{cls} `$表示对象分类损失：
```math
L_{cls} = \frac{1}{N_{cls}}\sum_iF_{cls}(R_{i}^{cls}(\theta ),b_{j}^{cls})
```

$`R_{i}^{cls}(\theta ) `$表示基于学习点得出的预测类别置信度，$`b_{j}^{cls} `$是指被指定的 gt 类别，$`F_{cls} `$是指Focal loss，$`N_{cls} `$表示点集的总数
$` L_{s1} `$ 和$` L_{s2} `$分别代表初始化阶段和细化阶段的空间定位损失。对于每个阶段，$`L_s`$可以表示如下：
```math
L_s = L_{loc} + L_{s.c.}
```

其中$`L_{loc}`$是基于转换的定向框的定位损失，而$`L_{s.c.}`$表示空间约束损失。  
设$`N_{loc}`$表示正样本点集的总数。$`b_{j}^{loc}`$表示 gt 的位置。因此，$`L_{loc}`$定义如下：

```math
L_{loc} = \frac{1}{N_{loc}}\sum_i[b_{j}^{cls}>=1]F_{loc}(OB_{i}^{loc}(\theta ),b_{j}^{loc}) 
```

这里的$`F_{loc}`$是针对定向多边形的 GIoU 损失[29]

由于航空图像中不同类别的多样性和杂乱的背景，学习到的部分点易受到背景或具有强烈关键特征的相邻对象的影响，这可能导致这些点移动到地面真实边界框之外。为了帮助这些容易受到影响的点捕捉其所属实例的几何特征，我们引入了一种有效的空间约束，对超出边界框的自适应点进行惩罚。让$`\rho_{ij}`$表示惩罚函数。每个定向对象的空间损失$`L_{S.C.}`$定义如下：
```math
L_{S.C.} = \frac{1}{N_a}\frac{1}{N_o} \sum_{i=1}\sum_{j=1}\rho_{ij}
```
其中，$`N_a`$表示每个对象的分配正点集样本的数量。 $`N_o`$是每个点集中在 GT 框之外的点数。  

设$`p_c`$表示地面真实边界框的几何中心。对于一个在边界框之外的采样点$`p_o`$，惩罚项定义如下：
```math
\rho = \left\{\begin{matrix}
  & \begin{Vmatrix}
P_o - P_c
\end{Vmatrix}, p_o&is&outside&GT
\\
  & 0,otherwise.
\end{matrix}\right.
```
<a id="3.3自适应点的评估和分配"></a>
### 3.3 自适应点评估和分配 Adaptive Points Assessment and Assignment
由于缺乏直接监督，学习高质量的点对于在航空图像中密集排列且方向任意的物体自适应捕捉几何特征至关重要。为此，我们提出了一种有效的评估和分配方案，用于衡量学习点的质量，并通过在训练阶段将自适应点的代表样本分配为正样本来实现这一目标。  

自适应点的质量评估。首先，我们从四个方面定义了一个质量度量$`Q`$ 来评估学习到的自适应点，包括分类和定位能力$`Q_cls`$ 、$`Q_loc`$ ，方向对齐$`Q_ori`$ ，以及每个定向点集的点对点相关性 $`Q_poc`$ 。因此，$`Q`$的推导如下：

```math
Q = Q_{cls} + \mu_1Q_{loc} + \mu_2Q_{ori} + \mu_3Q_{poc}
```

点集$`R_i`$的分类能力$`Q_{cls}`$直接反映了其分类置信度$`R^{cls}_{i}(θ)`$，其中相应的分类损失$`L_{cls}`$衡量了点特征与gt类别标签$`b^{cls}_{i}`$的兼容性。我们定义$`Q_{cls}`$如下：

```math
Q_{cls} (R_i,b_j) = L_{cls}(R^{cls}_{i}(\theta ),b^{cls}_{i})
```

为了评估点的位置与gt $`b^{loc}_{j}`$的兼容性，我们使用定位损失作为质量评估指标，该指标基于IoU变换。它指示了当点集的中心接近物体的几何中心时的空间对齐情况。因此，$`Q_{loc}`$的定义如下：

```math
Q_{loc} (R_i,b_j) = L_{loc}(OB^{loc}_{i}(\theta ),b^{loc}_{i})
```

由于$`Q_{loc}`$可以被视为空间位置距离的衡量标准，它对方向变化不敏感，尤其是对于航空图像中的类似正方形的物体。为了考虑方向对齐，我们采用Chamfer距离[5]来评估预测点集与地面真值框轮廓点之间的方向差异。我们首先采用MinAeaRect转换函数从学习到的点集中获得四个空间角点$`(v1, v2, v3, v4)`$。然后，我们以等间隔从相邻的两个角点中对应采样出一个有序点集$`R^v`$（默认情况下为40个点）。同样，对于地面真值的角点$`(g1, g2, g3, g4)`$，我们也生成了点集$`R^g`$。因此，$`Q_{ori}`$的定义如下：

```math
Q_{ori}(R_i,b_j) = CD(R_{i}^{v}(\theta ),R_{b_{j}}^{g})
```

CD表示上述两组采样点之间的Chamfer距离：
```math
CD(R^v,R^g) = \frac{1}{2n} \sum_{i=1}^{n} \min_{j}\left \|(x_i^v,y_j^v)-(x_i^g,y_j^g)  \right \|_2 + \frac{1}{2n} \sum_{j=1}^{n} \min_{i}\left \|(x_i^v,y_j^v)-(x_i^g,y_j^g)  \right \|_2 
```

$`(x_i^v,y_j^v)\in R^v`$ 表示预测的空间角点的采样点,  $`(x_i^v,y_j^v)\in R^v`$ 表示从gt角点生成的采样点。  

为了衡量针对定向对象的点集的点对点关联，我们提取点对点特征，并使用特征向量之间的余弦相似度作为学习自适应点的相关性度量 $`Q_{poc}`$。让$` e_{i,k} `$表示第 i 组自适应点的第 k 个点对点特征向量。$` e_{i,k}^* `$和 $` e_i^* `$分别代表归一化嵌入特征向量和它们的均值。

```math
e_{i,k}^* = \frac{e_{i,k}}{\left \| e_{i,k} \right \|_2 } 
```

```math
e_{i}^* = \frac{1}{N_p}\sum_{k=1}^{}e_{i,k}^*
```
这里的 $`N_p`$ 表示点集中点的数量， 默认设置为9。基于上述符号，第 i 组点集的 $`Q_{poc}`$ 可以被表述为点对点特征多样性，如下所示：

```math
Q_{poc} = 1 - \frac{1}{N_P}\sum_{k}^{}cos\left \langle e_{i,k}^*,e_{i}^*  \right \rangle
=  1 - \frac{1}{N_P}\sum_{k}^{}\frac{e_{i,k}^*\cdot e_{i}^*}{\left \| e_{i,k}^* \right \| \cdot \left \| e_{i}^* \right \|}
```

**动态 k 标签分配** 基于质量度量  $`Q`$ ，我们通过高效和动态的 top $`k`$ 项目选择方案在不同迭代中分配定向 reppoints 样本。对于每个物体，我们根据它们的质量得分对所有点集样本进行排序，从初始化阶段开始。为了获取高质量的自适应点集样本，我们设置一个采样比率 $`σ`$ 以分配每次迭代中的前 $`k`$ 个样本作为训练的正样本，计算方法如下：

```math
k = \sigma *N_t
```

这里的 $`N_t`$表示每个定向物体在初始化阶段的点集样本总数。

在训练过程中，使用点分配器[46]来获取初始化阶段中中心点的样本分配情况。在改进阶段，采用了提出的自适应点评估和分配（APAA）方案，根据质量度量 Q 选择高质量的点样本。只有被选定的正样本点集才会被分配目标的地面真实边界框。如图3所示，APAA方案使检测器能够预测高质量的定向 reppoints，从而提高分类置信度和定位得分。值得一提的是，所提出的方案仅用于训练，不会在推理阶段增加计算负担。

![image](https://github.com/Cloud-Jowen/CVPaper_Note/assets/56760687/6dd6b9a7-52fa-4c6a-9473-85484df2a9d7)  
(图3. 使用和不使用APAA方案的定向reppoints预测分类置信度和定位得分之间的相关性。)


<a id="4.实验Experiments"></a>
## 4.实验 Experiments

<a id="4.1评估测试平台"></a>
### 4.1 评估测试平台 Evaluation Testbed
**DOTA** 是一个用于评估航空图像中有方向物体检测性能的大规模数据集，包含2806张图像、188,282个实例和15个类别，其中包括各种方向、尺度和形状。训练集包括1411张图像，验证集包含458张图像，测试集由937张图像组成。图像大小范围从800×800到4000×4000不等。在我们的实验中，训练集和验证集均用于训练所提出的检测器，测试集则用于评估，但没有标注信息。我们将原始图像裁剪成1024×1024的补丁，并采用824的跨度。在训练阶段，我们对图像进行随机调整大小和翻转，以避免过拟合。

**HRSC2016** 包含大量来自几个著名港口的具有多样外观的条状有向物体图像，用于船只识别。整个数据集包括1061张图像，大小从300×300到1500×900不等。为了公平比较，我们使用训练集（436张图像）和验证集（181张图像）进行训练，测试集（444张图像）用于评估。

**UCAS-AOD** 共有1510张图像，其中包括510张汽车图像和1000张飞机图像。总共有14,596个实例。整个数据集被随机划分为755张图像用于训练，302张图像用于验证，453张图像用于测试，比例为5:2:3。所有图像的尺寸大约为1280×659。

**DIOR-R** 基于DIOR数据集 [16] 提供了有向边界框注释，用于有向检测任务。该数据集包括23,463张尺寸为800×800的图像，涵盖20个物体类别，共有192,518个实例。

<a id="4.2实验细节"></a>
### 4.2 实验细节 Implementation Details

我们的提出方法基于ResNet-50 [10]和ResNet-101骨干网络结合FPN [18]进行实现。在我们的工作中，FPN由P3到P7的金字塔级别组成。我们在训练中使用随机梯度下降（SGD）优化器。初始学习率设置为0.008，在前500次迭代中逐渐增加，然后在每次衰减步骤中以0.1的因子减小学习率。动量设置为0.9，权重衰减为10^-4。我们分别对DOTA、DIOR-R、HRSC2016和UCAS-AOD模型进行了40个、40个、120个和120个epochs的训练。在训练阶段采用了尺度抖动。Focal loss的超参数设置为$`α`$=0.25和$`γ`$=2.0。在公式（2）中，我们经验性地设置了每个阶段的平衡权重$`λ_1`$=0.3和$`λ_2`$=1.0。在公式（8）中，我们设置了品质评估Q的权重$`µ_1`$=1.0、$`µ_2`$=0.3和$`µ_2`$=0.1。我们进行了一系列实验来选择表6中采样比例σ的合适值。我们在一台配备4个RTX 2080Ti GPU的服务器上进行实验，总批处理大小为8（每个GPU 2张图像）进行训练，而在推断阶段则使用单个RTX 2080Ti GPU。

<a id="4.3消融实验"></a>
### 4.3 消融实验 Ablation Study
为了检验我们提出的框架中每个组件的有效性，我们在DOTA数据集上使用ResNet-50-FPN进行了一系列消融实验。

**定向转换函数的评估**  传统的基于点集的目标检测器RepPoints [46]通过诸如最小-最大（min-max）之类的正方形转换函数获得直立边界框，但这种方法无法处理具有任意方向的航空目标。为了建立一个合理的基准，我们比较了不同的转换函数，在训练和后处理期间将适应点映射到定向框内。表1显示了实验结果。

![image](https://github.com/Cloud-Jowen/CVPaper_Note/assets/56760687/4b1907d7-a960-4d32-9e97-656659e1bbb0)  
(表 1. 不同转换函数的比较。)

基于原始的RepPoints模型，使用训练和后处理中的最小-最大函数，能够达到49.69%的mAP。而使用我们提出的定向MinAeraRect函数进行后处理以获得旋转的矩形框，则能够达到53.21%的mAP。使用可微分的定向NearestGTCorner和ConvexHull函数，我们的定向RepPoints分别获得了66.97%和68.89%的mAP，表明定向转换函数对航空目标检测至关重要。

**与基于角度的检测器比较**  为了检验自适应点表示方法的有效性，我们将我们的方法与基于角度的定向回归在基于锚点的检测器上进行了比较。就像 $`S^2A-Net`$ [8]中那样，基于角度的检测器在初始化阶段为每个特征图位置预设一个正方形锚点，其中预测的基于角度的框被视为下一阶段获取定向边界框的优化锚点。表2展示了具有不同骨干网络的两个检测器的结果。在使用ResNet-50-FPN和ResNet-101-FPN作为骨干网络时，定向RepPoints分别比基于角度的定向回归性能提高了+1.39%和+1.46%的mAP。

![image](https://github.com/Cloud-Jowen/CVPaper_Note/assets/56760687/f714d870-e337-47e1-a951-9f8e98459d43)  
(表 2. 直接基于角度的定向回归和定向 RepPoints 在定向目标检测中的比较。)


**对空间约束的评估** 为了研究空间约束的有效性，我们将其与不使用空间约束的基准方法进行了比较。表3显示了实验结果。可以观察到，我们提出的空间约束非常有效，特别是对于具有弱特征表示的航空目标，比如直升机（HC），以及类似背景的物体，例如棒球场（BD）、桥梁（BR）和环状交叉路口（RA）。这是因为空间约束强制使自适应点位于它们所属的实例对象上。

![image](https://github.com/Cloud-Jowen/CVPaper_Note/assets/56760687/87a4b780-cc68-4a4a-92d2-3015f8b4a432)  
(表 3. 空间约束性能评估。BD，BR，RA 和 HC 分别代表棒球场，桥梁，环岛和直升机的类别。)

**用于自适应点学习的APAA方案** 为了研究所提出的用于自适应点学习的APAA方案，我们首先逐项报告质量评估项的性能。表5给出了在质量评估指标Q的不同设置下的结果。检测结果逐步改善，并且所提出的方法在使用所有四个项时获得了最佳性能，mAP为75.97%，增益为+5.86%。这表明质量评估指标能够有效反映用于航空目标检测的自适应点的质量。

![image](https://github.com/Cloud-Jowen/CVPaper_Note/assets/56760687/883fa0cf-e634-48a4-8ef1-0c7cd9678d19)  
(表 5. 对 APAA 方案中质量度量 Q 不同设置的性能评估。)

在APAA方案中，分配的自适应点样本数量由采样比率σ确定。如表6所示，在σ = 0.4时，模型实现了最佳性能。

![image](https://github.com/Cloud-Jowen/CVPaper_Note/assets/56760687/2ca182ad-87f0-41d5-bc31-a9406d297803)  
(表 6. 对 APAA 方案中动态 top k 分配的不同 σ 值进行评估。)

此外，我们将我们的APAA方案与其他用于训练所提出的检测器的样本分配方案进行了比较，包括最大IoU [28]、ATSS [48]、PAA [13]和CFA [7]。正如表7所示，我们的APAA方案在没有复杂操作的情况下实现了最佳性能，这证明了我们所提出的APAA方案对于自适应点学习是有效的。

![image](https://github.com/Cloud-Jowen/CVPaper_Note/assets/56760687/be7b386f-56ef-4220-bf02-5c718da57649)  
(表 7. 不同样本分配方法在定向 RepPoints 检测器上的比较。)


<a id="4.4和SOTA方法比较"></a>
### 4.4 和SOTA方法比较 Comparison with the State-of-the-art methods
**在DOTA数据集上的结果**。我们报告了单尺度的完整实验结果，以便与之前的方法进行公平比较。使用ResNet-50-FPN和ResNet-101-FPN作为骨干网络，我们的方法分别获得了75.97%和76.52%的平均精度（mAP）。它优于其他使用相应骨干网络的方法。在使用Swin-Transformer的微小版本（Swin-T-FPN）作为骨干网络，并结合随机旋转和HSV转换时，我们实现了77.63%的mAP，表现最佳。图4展示了在DOTA测试集上的一些可视化结果。

![image](https://github.com/Cloud-Jowen/CVPaper_Note/assets/56760687/bf52d499-7dbe-4538-92de-054c6b5ca122)  
(图 4. 在 DOTA 测试集上的 Oriented RepPoints 的示例检测结果。)


**在HRSC2016数据集上的结果**。为了全面比较HRSC2016数据集，我们使用VOC2007和VOC2012指标报告了结果。表8显示了实验结果。我们的定向RepPoints在使用ResNet-50-FPN骨干网络时在VOC2012度量下取得了最佳性能，并在VOC2007度量下排名第二。

![image](https://github.com/Cloud-Jowen/CVPaper_Note/assets/56760687/25de8342-490b-49c3-b7a8-e0caffc0e581)  
(表 8. 在 HRSC2016 测试集上的结果。mAP(07) 和 mAP(12) 分别代表 VOC2007 和 VOC2012 的平均精度（mAP）指标下的结果。)

**在UCAS-AOD数据集上的结果**。UCAS-AOD数据集包含大量具有复杂环境的小目标。表9显示了与该数据集上最新方法的评估结果。我们提出的方法取得了90.11%的mAP，表现最佳。

![image](https://github.com/Cloud-Jowen/CVPaper_Note/assets/56760687/5b28256c-a80d-48ad-bdfe-a4176041f8e8)  
(表 9. 在 UCAS-AOD 数据集上的性能比较。)

**在DIOR-R数据集上的结果**。DIOR-R数据集包含20类航空目标。与该数据集上的最新方法相比，我们实现了66.71%的mAP，表现最佳，并超越了其他方法，如表10所示。

![image](https://github.com/Cloud-Jowen/CVPaper_Note/assets/56760687/d0951154-ff8c-49d4-a8c5-c6a7b7c7eb4b)  
(表 10. 在 DIOR-R 数据集上的检测精度。所有实验结果均使用 ResNet-50-FPN 骨干网络执行。)

<a id="4.5对方向准确性的评估"></a>
### 4.5 对方向准确性的评估 Evaluation on Orientation Accuracy
我们进一步进行实验，评估在DOTA数据集上使用ResNet-50-FPN骨干的定向检测器的方向精度。我们采用所有类别的平均方向误差（mAOE◦）作为评估指标。如表11所示，我们提出的方法获得了最小的方向误差，这表明相较于传统的基于方向回归的方法，我们基于点集的方法对于精确的定向目标检测是有效的

![image](https://github.com/Cloud-Jowen/CVPaper_Note/assets/56760687/0b62b00b-6f09-460b-af88-538e8f95c0de)  
(表 11. 在 DOTA 数据集上定向误差的比较。所有实验均使用训练集进行训练，验证集进行测试。)

<a id="5.结论Conclusion"></a>
## 5.结论 Conclusion
本文提出了一种有效的航空目标检测器，利用自适应点作为细粒度表示，能够捕捉任意方向、混乱和非轴对齐目标的关键几何特征。为了有效地学习自适应点，我们引入了质量评估和样本分配方案，以衡量和选择高质量的训练样本点。此外，我们使用空间约束来惩罚位于定向框外部的点，以实现稳健的自适应点学习。我们在四个测试平台上进行了大量实验证明了我们提出的方法的有效性。
