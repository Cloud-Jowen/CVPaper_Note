# Oriented RepPoints for Aerial Object Detection

[**相关链接**](#相关链接)  
[**0.摘要 Abstract**](#0.摘要Abstract)  
[**1.介绍 Introduction**](#1.介绍Introduction)  
[**2.相关工作 Related work**](#2.相关工作Relatedwork)  
&emsp;[**2.1 有向目标检测**](#2.1有向目标检测)  
&emsp;[**2.2 非轴对齐特征学习**](#2.2非轴对齐特征学习)  
&emsp;[**2.3 目标检测样本分配**](#2.3目标检测样本分配)  
[**3.网络结构**](#3.网络结构)  
&emsp;[**3.1 Overview**](#3.1Overview)  
&emsp;[**3.2 有向点自适应学习**](#3.2有向点自适应学习)  
[**4.实验 Experiments**](#4.实验Experiments)  
[**5.结论 Conclusion**](#5.结论Conclusion)  



## 相关链接
参考博文链接：  
参考视频链接：  
源码链接：  
论文链接：  

<a id="0.摘要Abstract"></a>
## 0.摘要 Abstract
与通用对象相比，航空目标通常不是轴对齐的，具有任意方向并且周围环境混乱。与主流方法通过回归边界框方向不同，本文提出了一种有效的自适应点学习方法，通过利用自适应点表示法来实现对航空目标的检测，能够捕捉任意方向实例的几何信息。为此，提出了三种定向转换功能，以促进具有准确方向的分类和定位。此外，我们提出了一种有效的质量评估和样本分配方案，用于自适应点学习，以在训练过程中选择代表性的有方向的重点样本，并能够捕捉邻近对象或背景噪声的非轴对齐特征。引入了空间约束来惩罚异常点，以实现鲁棒的自适应学习。在包括DOTA、HRSC2016、UCAS-AOD和DIOR-R在内的四个具有挑战性的航空数据集上的实验结果证明了我们提出的方法的有效性。源代码可在以下链接找到：https://github.com/LiWentomng/OrientedRepPoints。

<a id="1.介绍Introduction"></a>
## 1.介绍 Introduction
作为一个重要的计算机视觉任务，航空目标检测最近引起了越来越多的关注，在远程图像理解中发挥着重要作用。与通用目标检测不同，航空目标定位具有自身的困难，包括具有任意方向的非轴对齐对象和具有复杂上下文的密集分布。主流方法通常将航空目标检测视为旋转对象定位的问题。其中，基于直接角度的定向回归方法主导了这一研究领域，这些方法源自通用的普通检测器，并具有额外的定向参数。尽管已经取得了令人满意的性能，但直接的定向预测仍然存在一些问题，包括损失的不连续性和回归的不一致性。这主要是由于角度方向的周期性限制以及旋转边界框的定义所致。尽管它们具有吸引人的定位结果，基于方向回归的检测器可能无法准确预测方向，如图1-(a)所示。

![image](https://github.com/Cloud-Jowen/CVPaper_Note/assets/56760687/8a478255-555a-42fe-ab17-6c33493eb207)  
(图1中，(a)表示基于方向回归方法的常见基准线RetinaNet [19]，(b)是我们提出的Oriented RepPoints的基准方法。与直接的方向回归相比，我们的方法可以通过学习标记为红色的自适应点来更准确地估计方向。)

为了有效解决上述问题，我们重新审视了航空物体的表示形式，以避免对敏感方向的估计。作为一种细粒度的对象表示，点集表现出很大的潜力，可以捕获传统通用检测器中的关键语义特征，如RepPoints [46]所示。然而，它的简单转换函数只能产生直立水平的边界框，无法精确估计航空物体的方向。此外，RepPoints只根据语义特征回归关键点，而忽略了有效衡量学习点质量的问题。这可能导致在航空图像中具有密集分布和复杂场景的非轴对齐物体的性能不佳。

在本工作中，我们提出了一种面向航空图像的定向物体检测器，名为Oriented RepPoints，它引入了适应性点表示，用于多样化的方向、形状和姿态。与传统的方向回归方法相比，我们提出的方法不仅可以实现精确的航空检测和准确的方向估计，而且可以捕获任意方向的航空实例的基础几何结构，如图1所示。具体来说，初始的适应性点是从中心点生成的，然后进一步调整以适应航空物体。为了获得定向边界框，我们根据学习点的布局提出了三个定向转换函数。此外，我们提出了一种有效的自适应点评估和分配（APAA）方案，用于点集学习，该方案在训练过程中不仅从分类、定位角度评估定向Reppoints的质量，还从它们的方向和点特征相关性来衡量。这种方案使检测器能够捕获相邻物体或背景噪声中的非轴对齐特征，从而分配代表性的定向Reppoints样本。此外，我们提出了一个空间约束，以帮助脆弱的点在航空场景中找到它们的实例所有者。与基于方向回归的方法相比，我们的框架获得了更精确的检测性能和准确的方向估计。

总之，本文的主要贡献包括：  
（1）提出了一种名为Oriented RepPoints的有效航空目标检测器，其中引入了灵活的自适应点作为表示，实现了定向目标检测；  
（2）针对自适应点学习，提出了一种新颖的质量评估和样本分配方案，该方案不仅从分类、定位角度选择点样本，还从方向、点特征相关性方面进行选择；  
（3）在四个具有挑战性的数据集上进行了大量实验，展示了有希望的定性和定量结果。  

<a id="2.相关工作Relatedwork"></a>
## 2.相关工作 Related work
与大多数使用水平边界框的通用物体检测器不同，航空图像中的目标通常是任意方向的，并且密集分布。我们将在接下来讨论相关工作。

<a id="2.1有向目标检测"></a>
### 2.1 有向目标检测 Oriented Object detection
最近的航空目标检测方法主要是从经典的物体检测器中引入了方向回归。SCRDet [45]、CADNet [47]、DRN [24]、R3Det [42]、ReDet [9]和Oriented RCNN [36]通过预测边界框的旋转角度实现了令人满意的性能。Gliding Vertex [37]和RSDet [25]通过回归四边形改进了检测结果。为解决基于角度的方向估计中的边界不连续性，Yang等人将角度回归转换为角度分类 [40]。随后，Yang等人将旋转边界框的参数化转换为2-D高斯分布，这为定向目标检测获得了更加稳健的结果。这些方法致力于利用旋转角度表示来改善方向估计。相反，本文引入了一种更有效的表示，即使用自适应点。

<a id="2.2非轴对齐特征学习"></a>
### 2.2 非轴对齐特征学习 Non-axis Aligned Features Learning
大多数传统的目标检测方法 [?, ?, 26, 28, 31, 46, 51] 集中于垂直或轴对齐的对象，而对于在复杂背景中密集分布的非轴对齐目标可能存在困难。为了解决这个问题，Ding等人 [3] 对轴对齐的感兴趣区域 (RoIs) 进行空间变换，并在定向边界框的监督下学习非轴对齐表示。SCRDet++ [44] 增强了非轴对齐特征，并通过训练网络带来更高的对象响应。Han等人 [8] 设计了一个特征对齐模块，以减轻轴对齐卷积特征与任意定向对象之间的错位。DRN [24] 提出了特征选择模块，以从不同的核大小、形状和方向中聚合非轴对齐信息，并采用动态滤波器生成器进行进一步回归。Guo等人 [7] 使用凸包表示来学习不规则的形状和布局，旨在通过可学习的特征适应避免特征混叠。我们基于点集的方法旨在捕捉非轴对齐航空目标的关键特征。

<a id="2.3目标检测样本分配"></a>
### 2.3 目标检测样本分配 Samples Assignment for Object Detection
大量的检测方法采用了一种简单的方式来设置IoU阈值来选择正样本。然而，这样的方案由于潜在的噪声和困难情况，无法保证训练样本的整体质量 [15, 22]。一些最近的通用目标检测样本分配方法，如ATSS [48]、FreeAnchor [49]、PAA [13] 和OTA [6]，采用了学习匹配优化策略 [50] 来选择高质量的样本。在航空场景中，由于方向的多样性和密集分布，选择高质量的样本对于学习定向检测器至关重要。Ming等人 [23] 引入了匹配度量度来评估基于定向锚点的空间对齐，使用匹配敏感损失来增强分类和定向定位之间的相关性。在这项工作中，我们建议一个有效的质量评估和样本分配方案，以选择正样本点样本。

<a id="3.网络结构"></a>
## 3.网络结构
<a id="3.1Overview"></a>
### 3.1 Overview
与传统方法 [3, 8, 9, 45] 直接回归方向不同，我们利用自适应点集 [46] 作为一种细粒度表示，能够捕捉在混乱环境中方向变化明显的航空目标的几何结构。为此，我们引入了可微分的转换函数，其中代表性点被驱使自适应地向定向对象的适当位置移动。为了有效地学习高质量的自适应点而无需直接进行点对点的监督，我们提出了一个质量评估方案，在训练阶段选择高质量的定向代表点。为了促进鲁棒的自适应点学习，我们采用空间约束来惩罚易受攻击的离群值，并从复杂的航空背景中找到它们的实例所有者。图2显示了我们提出的定向代表点方法的概述。

![image](https://github.com/Cloud-Jowen/CVPaper_Note/assets/56760687/b5081256-b1a0-4adb-9dc3-ef703e951789)  
(图2. 定向Reppoints的框架。所提出的方法是一种无锚点的方法，采用自适应点作为表示，其中使用带有FPN网络的主干进行特征编码。共享头部的结构与RepPoints [46] 在每个FPN尺度上的结构相同，除了所提出的APAA和定向转换函数。基于从初始化阶段学习点的情况，APAA方案仅在训练期间执行。)

<a id="3.2有向点自适应学习"></a>
### 3.2 有向点自适应学习 Adaptive Points Learning with Orientation
为了促进具有点集表示的定向检测器，引入了转换函数将自适应点转换为定向边界框。设G表示定向转换函数如下：
```math
OB = G(R)
```
其中OB表示从学习到的点集R转换而来的定向框。在本文中，我们研究了三种定向转换函数：  
• MinAreaRect旨在从学习的点集中找到具有最小面积的旋转矩形，适用于定向对象。  
• NearestGTCorner利用地面实况注释。对于每个角落，我们从学习到的点集中找到最接近的点作为预测的角落，选择的角点用于构建一个四边形作为定向边界框。  
• ConvexHull。一个定向实例多边形可以被定义为一组由Jarvis March算法 [7, 11]生成的点的凸包，这被许多基于轮廓的方法所使用。  

需要注意的是，NearestGTCorner和ConvexHull是可微分函数，而MinAeraRect不是。因此，我们在后处理中使用MinAeraRect来获得标准的旋转矩形预测，而另外两个可微分函数则用于优化训练过程中的自适应点学习。在定向地面实况注释的监督下，这些点针对每个空中对象的语义关键点和几何特征进行自适应调整，同时受到分类和定位损失的驱动。

所提出的框架包括两个阶段。初始化阶段通过从对象中心点（特征图网格）精炼生成自适应点集。进一步的细化阶段通过最小化如下损失函数获得精确调整：
```math
L = L_{cls} + \lambda_1 L_{s1} +\lambda_2 L_{s2}
```
其中 $` \lambda_1 `$ 和$` \lambda_2 `$是平衡权重。$` L_{cls} `$表示对象分类损失：
```math
L_{cls} = \frac{1}{N_{cls}}\sum_iF_{cls}(R_{i}^{cls}(\theta ),b_{j}^{cls})
```

$`R_{i}^{cls}(\theta ) `$表示基于学习点得出的预测类别置信度，$`b_{j}^{cls} `$是指被指定的 gt 类别，$`F_{cls} `$是指Focal loss，$`N_{cls} `$表示点集的总数
$`L_{s1}`$和$`L_{s2}`$分别代表初始化阶段和细化阶段的空间定位损失。对于每个阶段，$`L_s`$可以表示如下：
```math
L_s = L_{loc} + L_{s.c.}
```
其中$`L_{loc}`是基于转换的定向框的定位损失，而$`L_{s.c.}`表示空间约束损失。  
设$`N_{loc}`$表示正样本点集的总数。$`b_{j}^{loc}`$表示 gt 的位置。因此，$`L_{loc}`$定义如下：
```math
L_{loc} = \frac{1}{N_{loc}}\sum_i[b_{j}^{cls}>=1]F_{loc}(OB_{i}^{loc}(\theta ),b_{j}^{loc}) 
```
这里的$`F_{loc}`$是针对定向多边形的 GIoU 损失[29]
<a id="4.实验Experiments"></a>
## 4.实验 Experiments

<a id="5.结论Conclusion"></a>
## 5.结论 Conclusion

