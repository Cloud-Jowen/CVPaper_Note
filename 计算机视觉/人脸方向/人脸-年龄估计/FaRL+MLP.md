# Learning Expectation of Label Distribution for Facial Age and Attractiveness Estimation

[**相关链接**](#相关链接)  
[**0.摘要 Abstract**](#0.摘要Abstract)  
[**1.介绍 Introduction**](#1.介绍Introduction)  
[**2.相关工作 Related work**](#2.相关工作Relatedwork)  
[**3.网络结构**](#3.网络结构)  
[**4.实验 Experiments**](#4.实验Experiments)  
[**5.结论 Conclusion**](#5.结论Conclusion)  



## 相关链接
参考博文链接：  
参考视频链接：  
源码链接：  https://github.com/paplhjak/facial-age-estimation-benchmark
论文链接：  https://arxiv.org/pdf/2007.01771v2.pdf

<a id="0.摘要Abstract"></a>
## 0.摘要 Abstract
通过使用卷积神经网络（CNN），面部属性（如年龄和魅力）的估计性能得到了显著提高。然而，现有方法在训练目标和评估指标之间存在一致性不足的问题，因此可能不够优化。此外，这些方法通常采用具有大量参数的图像分类或人脸识别模型，从而导致计算成本高昂和存储开销大。本文首先分析了两种最先进方法（Ranking-CNN和DLDL）之间的基本关系，并表明Ranking方法实际上隐含地学习了标签分布。因此，我们首次将这两种流行的最先进方法统一到了DLDL框架中。其次，为了减少一致性问题并降低资源消耗，我们设计了一种轻量级网络架构，并提出了一个统一的框架，可以同时学习面部属性分布和回归属性值。我们的方法在面部年龄和魅力估计任务上证明了其有效性。我们的方法使用单一模型取得了SOTA结果，仅包含原始模型36倍的参数数量，并且推理速度提高了3倍。此外，即使将参数数量进一步减少到0.9M（3.8MB磁盘存储），我们的方法仍能够达到与SOTA相媲美的结果。

<a id="1.介绍Introduction"></a>
## 1.介绍 Introduction
人脸包含了许多重要的个体特征信息，例如身份、表情、年龄、魅力和性别。这些信息已经被广泛应用于实际应用领域，如视频监控、客户画像、人机交互和个人识别。在这些任务中，开发自动年龄和魅力估计方法近年来成为一个有吸引力但具有挑战性的课题。

从面部图像中找到年龄和魅力的任务为什么具有挑战性呢？首先，与图像分类或人脸识别相比，现有的面部属性数据集往往非常有限，因为很难收集到完整且充分标注的数据集。例如，ChaLearn15明显年龄估计挑战赛中只有2476张训练图像。其次，不同标签组中的图像数量非常不平衡。此外，不同数据集的分布也非常不同。如图1所示，ChaLearn16（大约2岁和26岁处有两个峰值）和Morph（大约20岁和40岁处有两个峰值）上有两个峰值，而ChaLearn15只有一个峰值。类似的现象也出现在面部魅力数据集中。这些不平衡为开发一个准确可靠的年龄和魅力估计方法带来了严重的挑战。第三，与其他面部属性（如性别或表情）相比，年龄/魅力估计是一个非常精细的识别任务，例如，当一个人从25岁长到26岁时，我们人类很难察觉到他/她面部特征的变化。

我们是否可以使用一个统一的框架来有效地从面部图像中估计年龄和魅力呢？首先，这两个任务都是基于面部图像的，因此有可能使用一个统一的基础模型。其次，无论是年龄估计还是面部魅力评估，标签都是有序的。通常情况下，它们都被整合到序数回归或序数分类的主题中，其主要特点是类别在自然或暗示的顺序中相关联。这种任务的常见示例包括电影和面部魅力评分（例如从1星到5星）或面部年龄（例如从婴儿到儿童到成年人）或图像美学（例如从“不可接受”到“专业”到“卓越”）。第三，在面部年龄和魅力任务中，任意两个相邻标签之间存在不确定性信息，并且它们的评估指标通常都使用平均绝对误差（MAE）。因此，我们尝试在本文中将面部年龄和魅力估计整合到一个统一的框架中。

面部属性估计的常见评估指标是预测值与实际数值之间的平均绝对误差（MAE）。因此，将面部属性估计视为度量回归问题[6]，即最小化MAE，是非常自然的。然而，这样的方法通常无法达到令人满意的性能，因为一些异常值可能会导致大的误差项，从而导致不稳定的训练过程。后来，Rothe等人[7]训练了深度卷积神经网络（CNN）进行年龄估计，将其视为多类分类问题，最大化地考虑了实际类别的概率，而不考虑其他类别。由于类别之间的不平衡问题和有限的训练图像，这种方法很容易产生过拟合[8]。

最近，排名CNN[9, 10, 11, 12]和深度标签分布学习（DLDL）技术在面部年龄估计上取得了最先进的性能。这两种方法都利用了不同层级上相邻年龄之间的相关信息。排名方法将单值估计转换为一系列二元分类问题，在训练阶段直接从这些二元输出中聚合排名器的输出。DLDL首先将实数值转换为离散标签分布。然后，训练的目标是拟合整个分布。在推断阶段，像[7]一样，预测分布上的期望值被视为最终输出。我们很容易发现所有这些方法中训练目标和评估指标之间存在不一致性。因此，它们可能不是最优的。如果消除这种不一致性，我们期望可以提高它们的性能。

此外，我们观察到几乎所有最先进的面部属性估计方法[14, 13, 7, 8, 15]都是由在大规模图像分类（如ImageNet [1]）或人脸识别（如VGGFace [2]）数据集上训练的预训练模型初始化，并在目标数据集上进行微调。这些预训练模型采用了一些流行且强大的架构（如VGGNet [16]）。不幸的是，这些模型通常具有巨大的计算成本和存储开销。以VGG-16为例，它有1.3834亿个参数，占用了超过500MB的存储空间。因此，很难部署在资源受限的设备上，例如手机。最近，一些研究人员致力于压缩这些预训练模型，以实现减少参数数量并保持精度的可能性[17]。与这些压缩方法不同，我们直接设计了一个轻量级的深度网络架构，并从头开始进行训练。

在本文中，我们将标签分布学习[23]和期望回归集成到一个统一框架中，以简单而轻量的CNN架构缓解训练和评估阶段之间的不一致性。所提出的方法有效且高效地提高了先前DLDL在面部属性估计的预测误差和推断速度上的性能，因此我们称其为DLDL-v2。我们的贡献总结如下。

（1）据我们所知，我们首次提供了关于排名方法实际上是在隐含地学习标签分布的分析，并展示了这一结果，从而将现有最先进的面部属性估计方法统一到了DLDL框架中；  
（2）我们提出了一个端到端的学习框架，该框架在特征学习和分类器学习中联合学习标签分布和相邻标签之间的相关信息，并对单一标签的真实值进行回归；  
（3）我们使用单一且小型模型在面部年龄和吸引力估计任务上创造了新的最先进结果，而无需外部年龄/吸引力标记数据或多模型集成；  
（4）我们提出的框架在一定程度上是可解释的。我们发现网络在估计不同年龄阶段的人的年龄时采用了不同的模式。同时，我们还定量分析了我们的方法对不同面部区域的敏感性。  

我们将本文其余部分组织如下。第2节介绍了关于面部属性（如年龄和吸引力）估计的相关工作。然后，第3节介绍了提出的DLDL-v2方法，包括问题定义、现有方法之间的关系，以及我们的联合学习框架及其模型架构。之后，在第4节报告了实验结果。在第5节，我们讨论了DLDL-v2如何对输入面部图像进行最终决策，并分析了它为什么能够很好地工作。最后，第6节给出了结论。一些初步结果已经在会议报告中发表[24]。






<a id="2.相关工作Relatedwork"></a>
## 2.相关工作 Related work


<a id="3.网络结构"></a>
## 3.网络结构


<a id="4.实验Experiments"></a>
## 4.实验 Experiments

<a id="5.结论Conclusion"></a>
## 5.结论 Conclusion










